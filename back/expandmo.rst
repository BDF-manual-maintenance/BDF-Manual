expandmo模块
================================================
expandmo模块主要实现小基组分子轨道到大基组的扩展，用于加速大基组分子轨道优化。另外实现定域与正则活性轨道的自动生成等功能。

**基本控制参数**

:guilabel:`Overlap` 参数类型：Bool型
------------------------------------------------
指定将SCF得到的小基组分子轨道扩展到大基组，用于加速大基组分子轨道优化。

:guilabel:`Overcri` 参数类型：浮点数
------------------------------------------------
指定针对关键字“Overlap”设置的轨道占据数阈值：占据数超过此阈值的轨道将被定义为占据轨道。
* 默认值：0.0

:guilabel:`Sb2lb` 参数类型：Bool型
------------------------------------------------
将小基组下的 MCSCF计算的分子轨道（MOs）作为大基组MCSCF计算的初始猜测轨道。具体示例可参考 test150.inp（示例文件）。

* 功能说明:
  基组扩展策略：通过小基组优化得到的轨道作为起点，加速大基组计算收敛。
  应用场景：适用于基组升级时的计算流程优化，减少迭代次数和计算资源消耗。
  文件指引：test150.inp 中演示了基组切换时轨道初始化的参数设置方法。

:guilabel:`Sbolb` 参数类型：Bool型
------------------------------------------------
指定计算轨道重叠矩阵。
计算并输出小基组（$BDF_WORKDIR/$BDFTASK.sbforb）与大基组（$BDF_WORKDIR/$BDFTASK.lbforb）的分子轨道（MOs）之间的重叠矩阵。

* 功能说明:
  作用：量化不同基组下分子轨道的重叠程度，辅助分析基组扩展对轨道特性的影响。
  输出形式：矩阵数据通常写入指定输出文件，格式为行列对应的数值表。
  典型应用：基组升级时的轨道连续性验证、活性空间自动选择前的轨道预筛选。

:guilabel:`S12cmo` 参数类型：Bool型
------------------------------------------------
指定计算两个不同分子构型之间的轨道重叠矩阵。

第一构型文件路径:
检查文件：$BDF_WORKDIR/$BDFTASK.chkfil1
正则分子轨道（CMO）文件：$BDF_WORKDIR/$BDFTASK.inporb1

第二构型文件路径:
检查文件：$BDF_WORKDIR/$BDFTASK.chkfil2
正则分子轨道（CMO）文件：$BDF_WORKDIR/$BDFTASK.inporb2

* 功能说明:
  作用：量化不同构型（如几何优化前后、反应路径节点）的分子轨道重叠程度，用于分析构型变化对电子态的影响。
  输出形式：矩阵数据通常写入指定输出文件，格式为行列对应的数值表。
  典型应用：过渡态分析、构型相关性研究、轨道连续性追踪。

:guilabel:`Core` 参数类型：整型数组
------------------------------------------------
指定计算所需的每个不可约表示的冻结双占据（inactive）轨道数。 

:guilabel:`Close` 参数类型：整型数组
------------------------------------------------
指定计算所需的每个不可约表示的未冻结双占据（inactive）轨道数。 

:guilabel:`Active` 参数类型：整型数组
------------------------------------------------
指定计算所需的每个不可约表示的活性（active）轨道数。 

:guilabel:`Acte` 参数类型：整型
------------------------------------------------
指定计算所需活性电子数。

:guilabel:`Phosp` 参数类型：整型
------------------------------------------------
设置投影杂化轨道（PHO）作为活性原子轨道，支持sp²/sp³/sp杂化体系建模。

示例如下：
PHOSP
2  ! 第一行：需杂化的原子总数
2 1 2 3 4 0  ! 第二行：sp²参数结构: (n=2) (中心原子1) (配位原子2,3,4) (0：一个位置无临近原子)
! 参数详解:
! 2 → 主量子数n=2 (操作2s/2p轨道)
! 1 → 中心原子编号1
! 2 3 4 → 三个配位原子编号
! 0 → 标记sp²杂化（非零值则触发sp³）
2 2 1 5 6 7  ! 第三行：sp³参数结构: (主量子数n=2) (中心原子2) (配位原子1,5,6,7) 
3 4 1 5 0 0  ! 第四行：sp参数结构:  (主量子数n=3) (中心原子4) (配位原子1,5) (0,0：两个位置无临近原子) 

* 注意：若用户想选特定杂化轨道，如sp³杂化轨道，但与所选原子紧邻的临位原子数不足，则可以用接近特定方向的次临原子替代。
        采用此关键词只是为了得到近似杂化原子轨道以得到特定键型分子轨道的初始猜测。最终分子轨道由MCSCF计算生成。

:guilabel:`Minbas` 参数类型：字符串型
------------------------------------------------
指定所选活性（杂化）原子轨道。若使用关键词“Phosp”，则表述选择杂化原子轨道。
第一行指定所选轨道的数目
第二行开始逐行设置所选原子轨道
* 必须严格使用COMPASS程序输出的原子轨道符号格式(不区分大小写)
  标准基组使用 "元素|轨道" 格式（如1Co|3D0）
  数字前缀"1"表示原子序号，"Co3"中的3表示基组编号，轨道符号必须与程序内部定义完全一致。
* 禁止自行修改轨道符号的命名规则

当启用PHOsp时，默认采用BDF程序的原子轨道排序规则：
1. 若所选原子与临位原子采用为sp³杂化
s0  → 与第1个临位原子相连的杂化原子轨道
p-1 → 与第2个临位原子相连的杂化原子轨道
p1  → 与第3个临位原子相连的杂化原子轨道
p0  → 与第4个临位原子相连的杂化原子轨道

2. 若所选原子与临位原子采用为sp²杂化
s0  → 与第1个临位原子相连的杂化原子轨道
p-1 → 与第2个临位原子相连的杂化原子轨道
p1  → 与第3个临位原子相连的杂化原子轨道
p0  → （近似）与S0，P-1，P1垂直的杂化原子轨道

3. 若所选原子与临位原子采用为sp杂化
s0  → 与第1个临位原子相连的杂化原子轨道
p-1 → 与第2个临位原子相连的杂化原子轨道
p1  → 孤对杂化原子轨道
p0  → 另一个孤对杂化原子轨道

:guilabel:`Avas` 参数类型：Bool型
------------------------------------------------
指定采用Atomic Valence Active Space（AVAS）方法生成包括由关键词“Minbas”所选原子轨道得到的活性分子轨道在内的准正则分子轨道。自动生成的双占据轨道、活性轨道、虚轨道按照能量从低到高排序。

:guilabel:`Vcmo` 参数类型：Bool型
------------------------------------------------
指定采用Imposed CAS（iCAS）方法生成包括由关键词“Minbas”所选原子轨道得到的活性分子轨道在内的准正则分子轨道。自动生成的双占据轨道、活性轨道、虚轨道按照能量从低到高排序。

:guilabel:`Localmo` 参数类型：Bool型
------------------------------------------------
指定将关键词“Vcmo”所生成的准正则分子轨道。按照双占据轨道、活性轨道、虚轨道分类定域化，生成定域分子轨道。
* 默认生成Pipek-Mezey型定域轨道。

:guilabel:`Vlmo` 参数类型：Bool型
------------------------------------------------
将Fock矩阵收缩至活性原子轨道，对角化Fock矩阵并局域化价层正则分子轨道（VCMOs），生成价层预局域分子轨道（pre-LMO）。
自动选择活性局域分子轨道（LMOs）或片段局域分子轨道（FLMOs）。

* 此功能仅支持无对称性体系。pre-LMOs目前仅支持从pre-CMOs通过局域化产生，暂不支持外部轨道输入。
* 默认定域化方法为Pipek-Mezey，可通过关键词“Boys”等使用其他定域化方法。

:guilabel:`Nolmocls` 参数类型：Bool型
------------------------------------------------
指定不定域化关键词“Vcmo”或“Vlmo”生成的双占据轨道。

:guilabel:`Nolmoact` 参数类型：Bool型
------------------------------------------------
指定不定域化关键词“Vcmo”或“Vlmo”生成的活性轨道。

:guilabel:`Nolmovir` 参数类型：Bool型
------------------------------------------------
指定不定域化关键词“Vcmo”或“Vlmo”生成的虚轨道。

:guilabel:`Pipek` 参数类型：Bool型
------------------------------------------------
指定将生成的准正则分子轨道定域化为Pipek-Mezey型定域分子轨道。
* 默认使用Mulliken电荷。若用户想采用Lowdin电荷，则输入关键词“Lowdin”。
* 默认使用一阶方法Jacobi sweep迭代生成定域分子轨道。若用户想用二阶方法trust-region，则输入关键词“Trust”。
  
:guilabel:`Boys` 参数类型：Bool型
------------------------------------------------
指定将生成的准正则分子轨道定域化为Boys型定域分子轨道。
* 不支持具有对称性的分子体系。

:guilabel:`mBoys` 参数类型：整型
------------------------------------------------
指定将生成的准正则分子轨道定域化为mBoys型定域分子轨道。
* 不支持具有对称性的分子体系。
* 示例：
mBoys
2  ! 指定powern值

:guilabel:`Cdloc` 参数类型：Bool型
------------------------------------------------
指定将生成的准正则分子轨道定域化为Cholesky型定域分子轨道。

:guilabel:`Maxcycle` 参数类型：整型
------------------------------------------------
指定定域化计算时的最大迭代次数。
* 默认值：3000

:guilabel:`Thresh` 参数类型：浮点数
------------------------------------------------
指定定域化迭代的两个收敛阈值。
* 默认值：1.d-6 1.d-6

:guilabel:`Highsym` 参数类型：Bool型
------------------------------------------------
指定高阶点群的原子轨道。


**算例**

:guilabel:`test071.inp`
------------------------------------------------

:guilabel:`test080.inp`
------------------------------------------------

:guilabel:`test086.inp`
------------------------------------------------

:guilabel:`test100.inp`
------------------------------------------------

:guilabel:`test114.inp`
------------------------------------------------

:guilabel:`test126.inp`
------------------------------------------------

:guilabel:`test131.inp`
------------------------------------------------

:guilabel:`test148.inp`
------------------------------------------------

:guilabel:`test150.inp`
------------------------------------------------


