
.. _mssm:

用MSSM模型研究自旋禁阻的多态反应
================================================

在大多数化学反应过程中，体系从反应物开始，经过一个或多个过渡态以及中间体，最后到达产物，整个反应都发生在基态的势能面上。
然而在有些情况下，反应物、过渡态、中间体、产物可能处于不同自旋态的势能面上，称为 **自旋禁阻反应** （Spin-Forbidden Reaction）或
**自旋禁阻的多态反应**，以下简称为 **多态反应** （Multiple-State Reaction）。这类反应的发生是由自旋轨道耦合导致的，进行理论研究具有一定的挑战性。

.. note::

    * 大多数多态反应仅涉及两个自旋态，故在一些文献中也称为 **两态反应** 。
    * 自旋守恒的化学反应也可能发生在自旋相同的两个（或多个）势能面上，但是如果不优化IRC，很难察觉。
      这种情况用常规理论方法即可处理，故不属于上面所说的多态反应。

在化学反应中严格考虑自旋轨道耦合，需要使用二分量或四分量相对论方法（特别是二分量和四分量相对论密度泛函理论，
已经在一些量子化学程序中实现了解析梯度），但是由于使用的困难，这类方法很少得到实际应用。
如果自旋轨道耦合不强，可以用最小能量交点方法近似处理，即优化两种自旋态势能面的最低能量交点（参见 :ref:`MECP<CI_MECP>` ）。
尽管MECP方法得到广泛应用，但是也存在一些不足：(1) 如果MECP对应新的过渡态，由于MECP并不是真正的驻点，无法获该点的振动频率和热化学量；(2) MECP
无法考虑两个以上自旋态的同时交叉，或在小区域内的相互交叉；(3) 如果MECP导致新过渡态，即便是不太重的3d元素，
MECP的位置和能量有时候也会和二分量相对论结果相差甚远 :cite:`Ricciarelli2020` ；(4) MECP不适用于锕系这类重元素体系；对于成键不饱和的5d体系，适用性存疑。

2018年，Truhlar等人提出了两态自旋混合模型（TSSM），用于模拟化学反应过程中两个自旋态之间的旋轨耦合 :cite:`Truhlar2018` 。
最近，我们将其推广为多态自旋混合模型（MSSM），适用于多个自旋态的情况，不仅避免了MECP方法的前三个缺点，并且对于5d以内的元素都是适用的 :cite:`Zhao2023`
对5d化合物反应的测试结果表明，MSSM-DFT与二分量DFT计算的反应（吸）放热、过渡态能垒高度相差在3 kcal/mol以内
（对于成键非饱和的5d化合物，需要用二分量或四分量方法做单点能校正）。

作为示例，以下我们用MSSM模型重复Truhlar等人用TSSM模型研究的钨络合物脱氢过程的两态反应
:math:`W(CH_3)(n-C_3H_7)(OH)_2 \rightarrow WH(CH_3)(=CHC_2H_5)(OH)_2` :cite:`Truhlar2018` 。
在文献中，作者用该体系做为原子层沉积多相钨催化剂的近似，其中载体骨架被两个OH基团取代。
反应的示意图如下所示，其中蓝线是单重态反应路径，红线是三重态反应路径，黑线是两态混合后的最低能量路径，黄线是单重态在最低混合态中所占的比例。
在整个反应中，钨的氧化态中从+4变为+6。由于在反应物中钨是部分配位的，因此三重态能量最低，自旋混合基态以三重态为主；
而在产物中的钨成键饱和，因此闭壳层单重态的能量最低，自旋混合基态以单重态为主。
三重态、单重态交点与自旋混合基态的过渡态仍有一定的距离（虽然能量比较接近），其中单重态在后者中占了90%左右，
也就是说，两种自旋态在过渡态并不是按照 1:1 的比例混合的，这是MSSM与MECP结果的最大区别。

.. figure:: /images/mssm-w.png

一般来说，用MSSM模型进行计算之前，首先要用常规的标量方法对各种可能的自旋态优化反应物，产物，过渡态，和中间体结构，
从中找到对反应起重要作用的自旋态以及MSSM优化计算的初始结构。
由于该反应已经在文献中进行了细致的研究 :cite:`Truhlar2018` ，我们跳过了这一步，
直接用MSSM优化这个两态反应在自旋混合基态势能面上的反应物，产物，和过渡态结构，并计算这三个驻点结构的振动频率。
初始分子坐标直接取自文献。
W的基组用def2-TZVP，其它原子的基组为6-31G*。SOC经验参数采用文献中的302 meV（2436 :math:`\rm cm^{-1}`）。
唯一不同的是，我们把文献中采用的M06L泛函改为B3LYP泛函，因为后者具有更好的数值稳定性。计算结果列于下表，
并附上文献中的结果 :cite:`Truhlar2018,Zhao2023` 作为对照：

.. table:: 钨络合物脱氢反应的过渡态虚频（:math:`\rm cm^{-1}`）和反应能量（kcal/mol；反应物能量作为零点）。
    :widths: auto

    +-------------+--------+--------+--------+
    | 方法        | 过渡态 |   产物 |   虚频 |
    +=============+========+========+========+
    | MSSM-B3LYP  |   25.6 |    3.2 |   924i |
    +-------------+--------+--------+--------+
    | TSSM-M06L   |   28.3 |    3.2 |   962i |
    +-------------+--------+--------+--------+
    | 2c-M06L     |   25.8 |    0.0 |        |
    +-------------+--------+--------+--------+


BDF计算输入
----------------

优化自旋混合基态反应物的输入如下，其中一些复制命令的含义参见 :ref:`ZnS分子自旋混合态算例<MultiStateMix>` 的注释）。

.. code-block:: bdf

    $compass
    title
       W system: reactant
    basis-block
     6-31G*
     W=def2-tzvp
    end basis
    # geom from PCCP 2018, 20, 4129
    geometry
    C  -2.50599000   0.80875000   0.27831700
    H  -2.42978000   0.87169600   1.37614800
    H  -3.29329400   1.52978300   0.00369300
    C  -1.17932200   1.22962500  -0.35262900
    H  -1.30089800   1.27432600  -1.45149600
    W   0.49596700  -0.04848100   0.05050100
    H  -0.94880200   2.26591700  -0.04284700
    C  -2.96148400  -0.58790000  -0.11445500
    H  -2.28153800  -1.36238600   0.26893400
    H  -3.96244500  -0.81403100   0.27115200
    H  -2.98974600  -0.70153100  -1.20640700
    O   1.64397700   1.44403300  -0.35823300
    H   1.22595200   2.31740600  -0.43846900
    O   0.49410200  -0.94895200   1.73966100
    H  -0.19914300  -0.83307900   2.40480100
    C   0.26970600  -1.43014300  -1.54486300
    H  -0.59187900  -2.09433400  -1.38019500
    H   0.07131900  -0.88842400  -2.48170400
    H   1.15657400  -2.06035000  -1.71035900
    end geometry
    nosymm
    $end

    $bdfopt
    multistate
     2soc  2436
    solver
     1
    hess
     final
    $end

    $xuanyuan
    $end

    %cp $BDF_WORKDIR/$BDFTASK.scforb.1   $BDF_WORKDIR/$BDFTASK.scforb    2>/dev/null || :
    $scf
    rks
    dft
     b3lyp
    grid
     fine
    $end
    %cp $BDF_WORKDIR/$BDFTASK.scforb     $BDF_WORKDIR/$BDFTASK.scforb.1

    $resp
    geom
    $end
    %cp $BDF_WORKDIR/$BDFTASK.egrad1     $BDF_WORKDIR/$BDFTASK.egrad.1   2>/dev/null || :
    %cp $BDF_WORKDIR/$BDFTASK.hess       $BDF_WORKDIR/$BDFTASK.hess.1    2>/dev/null || :

    %cp $BDF_WORKDIR/$BDFTASK.scforb.2   $BDF_WORKDIR/$BDFTASK.scforb    2>/dev/null || :
    $scf
    uks
    dft
     b3lyp
    spinmulti
     3
    grid
     fine
    $end
    %cp $BDF_WORKDIR/$BDFTASK.scforb     $BDF_WORKDIR/$BDFTASK.scforb.2

    $resp
    geom
    $end
    %cp $BDF_WORKDIR/$BDFTASK.egrad1     $BDF_WORKDIR/$BDFTASK.egrad.2   2>/dev/null || :
    %cp $BDF_WORKDIR/$BDFTASK.hess       $BDF_WORKDIR/$BDFTASK.hess.2    2>/dev/null || :

优化自旋混合基态产物的输入类似，以下只给出 ``compass`` 模块的输入，其余输入同上。

.. code-block:: bdf

    $compass
    title
       W system: product
    basis-block
     6-31G*
     W=def2-tzvp
    end basis
    # geom from PCCP 2018, 20, 4129
    geometry
    W  -0.42387000  -0.03021600  0.04243900
    O  -0.54695900  -1.59597800 -1.06031400
    H  -1.38476400  -2.05907900 -0.89227700
    O  -2.07683400  -0.36779800  1.01946300
    H  -2.09920000  -0.45365300  1.97932500
    C  -1.19429700   1.74966400 -0.81144000
    H  -1.16507500   2.46066600  0.03099700
    H  -0.64596000   2.20075800 -1.64296300
    H  -2.24817300   1.61217900 -1.08859500
    H   0.10061200   0.01381000  1.68243000
    C   1.39659000   0.37442700 -0.02642700
    H   1.22850000   0.24599300 -1.14781000
    C   2.78803600   0.62890000  0.40356700
    H   2.79144700   0.71717400  1.49877400
    H   3.12713400   1.60782200  0.02677600
    C   3.77244700  -0.45270200 -0.03426000
    H   4.78897300  -0.22737400  0.30879300
    H   3.48486900  -1.42988500  0.36906600
    H   3.80168700  -0.54392400 -1.12680400
    end geometry
    nosymm
    $end

优化自旋混合基态过渡态只需要修改反应物输入中 ``compass`` 、 ``bdfopt`` 两个模块的参数，如下：

.. code-block:: bdf

    $compass
    title
       W system: TS
    basis-block
     6-31G*
     W=def2-tzvp
    end basis
    # geom from PCCP 2018, 20, 4129
    geometry
    C   2.75476500  -0.49692100  0.66265200
    H   2.66846800  -0.03811600  1.65776400
    H   3.19563100  -1.49505600  0.81976100
    C   1.39220000  -0.59199800  0.03929900
    H   1.40125200  -1.14322200 -0.93707500
    W  -0.48542700  -0.04574900 -0.00978200
    H   0.62772500  -0.92650400  1.07995600
    C   3.68608400   0.33536600 -0.20966500
    H   3.29355400   1.35035000 -0.34119700
    H   4.68482600   0.40829800  0.23538400
    H   3.79640600  -0.10658300 -1.20747300
    O  -1.41339700  -1.47110300 -0.89277200
    H  -1.32731100  -2.36616000 -0.52320400
    O  -1.79388100   0.67727500  1.22320500
    H  -1.75031500   0.44148600  2.15765700
    C  -0.22357400   1.89123400 -0.83239900
    H   0.11804400   2.54791300 -0.01489800
    H   0.44852800   2.01363400 -1.68618700
    H  -1.23385200   2.22393900 -1.11944000
    end geometry
    nosymm
    $end

    $bdfopt
    multistate
     2soc  2436
    solver
     1
    hess
     init+final
    iopt
     10
    $end


