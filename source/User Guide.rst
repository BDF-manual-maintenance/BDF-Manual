4.  快速入门
************************************

本章将介绍BDF的各种功能的基本使用，针对具体的计算功能给出基本的算例和数据读取分析说明。

4.1  Hartree-Fock
================================================

分子体系的哈密顿算符包含多电子的相互作用，很难求解。HF方法将多电子问题转化为单电子问题求解。HF方法定义了Fock算符，它体现出每个电子在其他电子产生的平均势场中运动，这称为单电子近似。



4.2  Kohn-Sham
================================================



4.3  溶剂化模型
================================================



4.4  高斯基组
================================================

为了求解HF、KS-DFT方程，需要把分子轨道展开为单电子基函数的线性组合：

.. math::
    \varphi_{i}(r) = C_{1,i}\chi_{1}(r) + C_{2,i}\chi_{2}(r) + C_{3,i}\chi_{3}(r) + \dots + C_{N,i}\chi_{N}(r)

在量子化学的计算中，基函数只有数学意义，没有物理意义。基函数越多则结果越精确，但是也取决于怎么合理地设置基函数。当基函数无穷多，称为完备集，就达到了完备基组极限（Complete Basis set limit, CBS），能够完美展开分子轨道。实际用的基组尺寸是有限的而达不到CBS，由此导致的计算结果的误差称为基组不完备性误差。

用多少基函数，就会产生多少分子轨道，但是只有占据轨道，以及低阶的非占据轨道（价层空轨道）通常有化学意义。如果基函数取的就是原子轨道，称为原子轨道线性组合（linear combination of atomic orbitals，LCAO），但是这只是结构化学上纯概念的东西，实际计算中使用的基函数并不是真实的原子轨道。

量子化学中常用的基函数如下：

#. 高斯型函数（Gauss type function, GTF）：因其在数序形式上易于计算双电子积分，绝大多数量子化学程序使用的都是高斯型基函数。
#. Slater轨道（Slater type orbital, STO）：半经验以及少数量子化学程序（如ADF）所用的基函数。难以计算双电子积分，但相对于高斯型基组它的径向行为更接近于实际原子轨道，因此只需要较少数目的STO就可以达到较多数目GTF的计算结果。
#. 平面波（Plane wave）：专门适用于周期性计算的基函数，计算孤立体系时比高斯型基组性价比低得多。
#. 数值基组（Numerical basis set）：极少程序支持，典型的是Dmol3、Siesta。基函数并没有解析的数学形式，而是通过离散分布的点描述。

BDF软件采用的是高斯型基函数。



4.5  势能面和几何优化
================================================

几何优化的目的是找到体系势能面的极小点。能找到哪个极小点取决于输入文件中提供的初猜结构，离哪个极小点越近，一般越容易收敛到哪个极小点。

几何优化在数学上等价于寻找多元函数极值问题：

.. math::
    F_{i} = -\frac{\partial E(R_1,R_2,\dots,R_N)}{\partial R_i} = 0, i=1,2,\dots,N

几何优化常用算法如下：

#. 最速下降法（Steepest descent）：最速下降法就是沿着负梯度的方向进行线搜索，对于远离极小点的结构，最速下降法优化效率非常高，但临近极小点时收敛慢，容易震荡。
#. 共轭梯度法（Conjugate gradient）：共轭梯度法是最速下降法的改良，每步优化方向与前一步的优化方向相组合,能一定程度缓解震荡问题。
#. 牛顿法（Newton method）：牛顿法的思路是将函数相对于当前位置进行泰勒级数展开。牛顿法收敛很快，对于二次函数一步就可以走到极小点。但是牛顿法需要求解Hessian矩阵，计算非常太昂贵，一般几何优化中使用准牛顿法。
#. 准牛顿法（Quasi-Newton method）：准牛顿法通过近似方法构建 Hessian矩阵，当前步的Hessian矩阵基于当前步的受力和上一步的Hessian矩阵来得到。具体做法有多种，最常用的是BFGS法，还有DFP、MS、PSB等。由于准牛顿法的 Hessian是近似构建的，所以每一步优化的准确度低于牛顿法，达到收敛所需步数更多。但由于每一步耗时大为降低，所以优化总耗时还是显著减少了。


4.5.1.  基态结构优化
-------------------------------------------------------

4.5.2.  激发态结构优化
-------------------------------------------------------

4.5.3.  限制性结构优化
-------------------------------------------------------

4.5.4.  冗余坐标优化
-------------------------------------------------------

4.5.5.  几何优化常见问题
-------------------------------------------------------

4.5.5.1. 虚频问题
########################################################

4.5.5.2. 对称性问题
########################################################

4.5.5.3. 几何优化不收敛
########################################################

4.6  激发态计算
================================================





4.7  光谱
================================================

4.7.1 红外
-------------------------------------------------------

4.7.2 拉曼
-------------------------------------------------------

4.7.3 吸收
-------------------------------------------------------

4.7.4 发射
-------------------------------------------------------

4.7.5 旋轨耦合校正
-------------------------------------------------------

4.7.6 NMR
-------------------------------------------------------


4.8  数值Hessian
================================================



4.9  相对论效应
================================================



4.10  QM/MM
================================================



4.11  加速算法
================================================



4.12  波函数分析&单电子性质
================================================


