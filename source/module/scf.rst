scf模块
================================================
SCF模块是BDF的核心计算模块之一，进行Hartree-Fock和DFT计算。

**计算方法关键词**

:guilabel:`RHF/UHF/ROHF` 参数类型：Βοοl型
------------------------------------------------
如果做Hartree-Fock计算，这三个参数必须3选1，用于控制Hartree-Fock计算的类型。

``RHF`` Restricted Hartree-Fock
``UHF`` Unrestricted Hartree-Fock
``ROHF`` Restricted Open-shell Hartree-Fock

:guilabel:`RKS/UKS/ROKS` 参数类型：Βοοl型
---------------------------------------------------
如果做DFT计算，这三个参数必须3选1，用于控制DFT计算的类型。

``RKS`` Restricted Kohn-Sham
``UKS`` Unrestricted Kohn-Sham
``ROKS`` Restricted Open-shell Kohn-Sham

**波函数与占据数关键词**

:guilabel:`Charge` 参数类型：整数
------------------------------------------------
 * 默认值：0

指定计算的分子体系的电荷数。

:guilabel:`Spin` 参数类型：整数
---------------------------------------------------
 * 默认值：2S+1

指定计算的分子体系的自旋，这里输入的是自旋多重度。自旋多重度定义为2S+1，其中S是自旋角动量，它与体系内的单电子数N相关，S=N/2。所以自旋多重度也等于``单电子数+1``。

:guilabel:`Occupy` 参数类型：整数数组
------------------------------------------------
指定每个不可约表示分子轨道中双电子占据的轨道数目，用于RHF/RKS计算。

:guilabel:`Alpha & Beta` 参数类型：整数数组
---------------------------------------------------
Alpha & Beta必须联用，用于UHF/UKS计算，分别指定alpha或beta轨道每种不可约表示占据轨道数目。

**DFT交换相关泛函关键词**

:guilabel:`DFT` 参数类型：字符串
---------------------------------------------------
指定DFT计算的交换相关泛函。参见BDF支持的交换相关泛函列表。

:guilabel:`D3` 参数类型：Bool型
------------------------------------------------
指定对DFT计算加入Grimme的D3色散矫正。

:guilabel:`RS` 参数类型：浮点型
---------------------------------------------------
指定Range-Speration泛函如CAM-B3LYP等的系数。建议值：0.33。

**DFT数值积分格点控制参数关键词**

:guilabel:`NPTRAD` 参数类型：整型
---------------------------------------------------
指定数值积分径向格点数。一般本参数用于调试程序。

:guilabel:`NPTANG` 参数类型：整型
------------------------------------------------
指定数值积分角向格点数。一般本参数用于调试程序。

:guilabel:`COSXNGRID` 参数类型：字符串+整型+整型
---------------------------------------------------
指定在Coulpot+Cosx计算每种原子类型的径向与角向格点数。

.. code-block:: python

     #CH2分子，Coulpot+Cosx计算
     $scf
     RKS
     Coulpot+Cosx
     CosxNGrid
      C 20 194
      H 20 194
     ...
     $end

:guilabel:`Grid` 参数类型：字符串
------------------------------------------------
 * 默认值：Medium
 * 选值：Ultra Coarse、Coarse、Medium、Fine、Ultra Fine、SG1

指定DFT计算格点类型。

:guilabel:`Gridtype` 参数类型：整型
------------------------------------------------
 * 默认值：0
 * 可选值：0、1、2、3

指定DFT计算径向与角向布点方法。

:guilabel:`Partitiontype` 参数类型：整型
---------------------------------------------------
 * 默认值：
 * 可选值：0、1

指定DFT格点分割类型。0为Becke分割；1为Stratmann-Scuseria-Frisch分割。

:guilabel:`Numinttype` 参数类型：整型
------------------------------------------------
 * 默认值：0

指定数值积分计算方法，值为 x*10+y。

:guilabel:`NosymGrid` 参数类型：Bool型
---------------------------------------------------
指定数值积分是不使用分子对称性，仅用于程序调试。

:guilabel:`DirectGrid/NoDirectGrid` 参数类型：Bool型
-----------------------------------------------------
指定数值积分采用直接积分的模式，不保存基组值等信息。对于DirectSCF必须使用DirectGrid。只有少数非DirectSCF情况下NoDirectGrid。

:guilabel:`NoGridSwitch` 参数类型：Bool型
------------------------------------------------
指定数值积分过程不变换格点。为了降低计算量，BDF默认使用ultra coarse类型格点迭代几次DFT，到了一定的阈值，在使用用于设置的积分格点。NoGridSwitch参数强制不变换积分格点。

:guilabel:`ThreshRho & ThreshBSS` 参数类型：浮点型
---------------------------------------------------
控制积分格点的预筛选精度，仅用于程序调试。

:guilabel:`Coulpot` 参数类型：整型
------------------------------------------------
 * 默认值：0
 * 可选值：0、1、2

控制MEPC计算产生库伦势Vc与原子核吸引势Vn矩阵的方法。0为利用解析积分计算Vc与Vn；1为利用多级展开计算Vc，利用解析积分计算Vn；2为利用多级展开计算Vc，数值积分计算Vn。

:guilabel:`Coulpotmax` 参数类型：整型
---------------------------------------------------
定义多级展开最高的角动量L值。

:guilabel:`Coulpottol` 参数类型：整型
------------------------------------------------
 * 默认值：8

定义多级展开的精度阈值，越大越精确。

:guilabel:`COSX` 参数类型：Bool型
------------------------------------------------
指定利用COSX方法计算K矩阵。

:guilabel:`Coulpot+COSX` 参数类型：Bool型
------------------------------------------------
指定利用多级展开库伦势方法计算J矩阵， COSX方法计算K矩阵。

**SCF收敛控制关键词**

:guilabel:`Maxitter` 参数类型：整型
---------------------------------------------------
 * 默认值：50

定义SCF计算的最大迭代次数。

:guilabel:`Vshift` 参数类型：浮点型
------------------------------------------------
指定分子轨道能级移动值。对虚轨道人为的将轨道能加上用户指定数值，以加大HOMO-LUMO间隔，加速收敛。

:guilabel:`Damp` 参数类型：浮点型
---------------------------------------------------
指定本次SCF迭代与上次迭代的Fock矩阵如何混合。 Fi=(1-C)*Fi+C*Fi-1，从而加速SCF收敛。

:guilabel:`ThrEne` 参数类型：浮点型
------------------------------------------------
指定SCF收敛的能量阈值。

:guilabel:`ThrDen` 参数类型：浮点型
------------------------------------------------
指定SCF收敛的密度矩阵阈值。

:guilabel:`ThreshConverg` 参数类型：浮点型
---------------------------------------------------
同时指定SCF收敛的能量和密度矩阵阈值。

:guilabel:`NoDiis` 参数类型：Bool型
------------------------------------------------
指定不使用DIIS加速SCF收敛。

:guilabel:`MaxDiis` 参数类型：整型
---------------------------------------------------
 * 默认值：8

指定DIIS方法子空间维数。

:guilabel:`Iaufbau` 参数类型：整型
------------------------------------------------
 * 可选值：2、3

定义用什么方法指定占据轨道。

:guilabel:`Smeartemp` 参数类型：整型
---------------------------------------------------
通过引入高温，通过费米模糊化(Fermi Smearing)方法改变前线轨道的占据数，从而改善DFT的收敛。对于HOMO-LUMO能差非常小或者前线轨道能级简并的体系，该方法能改善DFT的收敛性。注意BDF如果使用Fermi Smearing方法，最终的能量包含了电子熵能(the electronic entropy)的贡献,名为-TS-ele，从E_tot中间减掉这一项是电子能量。

**Fock矩阵对角化控制关键词**

:guilabel:`Blkiop` 参数类型：整型
------------------------------------------------
 * 默认值：
 * 可选值：SAI、DDS、DNR、DGN、FNR、FGN、iVI、CHC

控制在SCF迭代中使用分块对角化方法，通常用于iVI或FLMO计算。

:guilabel:`Iviop` 参数类型：整型
---------------------------------------------------
控制用在SCF迭代中iVI方法，需要与Blkiop=7联用。

**打印与分子轨道输出控制参数**

:guilabel:`Print` 参数类型：整型
------------------------------------------------
 * 默认值：0
 * 可选值：0、1

仅用于程序调试，控制SCF的打印级别。

:guilabel:`IprtMo` 参数类型：整型
------------------------------------------------
 * 默认值：0
 * 可选值：0、1、2

控制如何打印分子轨道。0为仅打印前几个轨道占据数与轨道能；1为打印轨道能和占据数；2为打印所有分子轨道信息。

:guilabel:`Noscforb` 参数类型：Bool型
---------------------------------------------------
强制不将分子轨道存入bdftask.scforb文件。

:guilabel:`Pyscforb` 参数类型：Bool型
------------------------------------------------
控制将SCF收敛轨道存储为Pyscf轨道格式。

:guilabel:`Molden` 参数类型：Bool型
---------------------------------------------------
控制将分子轨道输出为Molden格式，以做后续的波函数分析。

**基组线性相关检查关键词**

:guilabel:`Checklin` 参数类型：Bool型
------------------------------------------------
强制SCF进行基组线性相关检查。BDF的SCF默认对DirectSCF进行基组线性相关检查，以提高SCF在包含弥散函数基组的收敛性。

:guilabel:`Tollin` 参数类型：浮点型
---------------------------------------------------
 * 默认值：1.D-7

控制基组线性相关检查的阈值。

**MOM方法控制关键词**

MOM是一种ΔSCF方法，可以通过强制SCF每次迭代的占据轨道与初始占据轨道最大重叠来使SCF收敛到激发态。MOM方法通常收敛比基态困难。

:guilabel:`IfPair & hpalpha, hpbeta` 参数类型：整型
---------------------------------------------------
Ifpair参数指定电子如何激发，确定MOM方法的电子占初态，必须与hpalpha和hpbeta参数联用。电子激发通过相对于基态通过指定从占据轨道到虚轨道的激发确定。

.. code-block:: python

      #一个分子，其分子轨道分属4个不可约表示，我们想激发不可约表示1的alpha分子轨道5、6上的电子到alpha轨道7、8，不可约表示3的alpha轨道3、4的电子到不可约表示1的轨道7、8
      $scf
      Ifpair
      Hpalpha
      2
      5 0 3 0
      8 0 4 0
      6 0 0 0
      9 0 0 0
      Hbeta
      1
      7 0 0 0
      8 0 0 0     
      ...
      $end

:guilabel:`Pinalpha & Pinbeta` 参数类型：整型
---------------------------------------------------
指定固定的分子轨道。
