分子结构优化 - BDFOPT模块
================================================
BDFOPT模块是BDF程序的分子几何结构优化模块，可用来寻找能量极小点、过渡态、锥形交叉点等。与其他模块不同，包含bdfopt模块的输入文件，并不是按照模块的先后顺序线性执行的，详见“快速入门”部分结构优化相关章节。

:guilabel:`Solver` 参数类型：整型
------------------------------------------------
 * 默认值：0
 * 可选值：0、1

指定几何结构优化使用的求解器。

Solver=0，BDF将使用外带的DL-Find优化器进行优化，该优化器支持在直角坐标或内坐标下，进行能量极小化、过渡态搜索、高阶鞍点搜索、锥形交叉点搜索、最小能量交叉点（MECP）搜索等。

Solver=1，BDF将使用自带的优化器进行优化。

如果在冗余内坐标下（参见ICoord关键词）进行能量极小化、过渡态搜索，建议使用Solver=1。

:guilabel:`Maxcycle` 参数类型：整型
---------------------------------------------------
指定最大优化步数。对于DL-Find优化器，默认值为50；对于BDF优化器，默认值为max(100, 6*原子数)。

:guilabel:`TolGrad` 参数类型：浮点型
------------------------------------------------
指定均方根梯度（RMS Gradient）的收敛标准，单位Hartree/Bohr。对于DL-Find优化器，默认值为2.D-4；对于BDF优化器，默认值为3.D-4。该参数同时还将梯度的最大分量（Max Gradient）的收敛标准设为TolGrad的1.5倍。

:guilabel:`TolEne` 参数类型：浮点型
---------------------------------------------------
 * 默认值：1.D-6

指定结构优化相邻两步能量变化的收敛标准，单位Hartree。该参数仅对DL-Find优化器有效。

:guilabel:`TolStep` 参数类型：浮点型
------------------------------------------------
 * 默认值：1.2D-3

均方根步长（RMS Step）的收敛标准，单位Bohr。该参数仅对BDF优化器有效。该参数同时还将步长的最大分量（Max Step）的收敛标准设为TolStep的1.5倍。

:guilabel:`IOpt` 参数类型：整型
---------------------------------------------------
 * 默认值：3
 * 可选值：3、10（当Solver=1时）；0、1、2、3、9、10、11、12、13、20、30、51、52（当Solver=0时）

指定优化目标。对于DL-Find优化器，该参数的意义与DL-Find的IOpt参数意义相同，用户可参见DL-Find手册；对于BDF优化器，仅支持其中的2个IOpt值，IOpt=3（优化极小值点）和IOpt=10（优化过渡态）。

:guilabel:`Trust` 参数类型：浮点型
---------------------------------------------------
 * 默认值：0.3
 * 可选值：非零实数

建议范围：0.005 ~ 0.5或-0.5 ~ -0.005

指定优化的置信半径（trust radius）。当置信半径r设定为正数时，程序的初始置信半径将设为r，但在随后的结构优化步骤中可能会视优化情况而动态地增加或减少置信半径。当置信半径r设定为负数时，程序的初始置信半径将设为|r|，且随后的结构优化步骤中保证置信半径不会超过|r|。

:guilabel:`Update` 参数类型：整型
------------------------------------------------
 * 默认值：对于极小值点优化为3，对于过渡态优化为2
 * 可选值：0、1、2、3、9

指定几何优化过程中Hessian的更新方式。0为每步均重新计算数值Hessian；1为Powell更新法（仅DL-Find支持）；2为针对过渡态的Bofill更新法；3为指定L-BFGS更新法（优化器为DL-Find），否则指定BFGS更新法；9为针对极小值点的Bofill更新法。如选择0以外的值，则程序将在几何优化的第一步构造基于分子力场的初始Hessian。

:guilabel:`ICoord` 参数类型：整型
---------------------------------------------------
 * 可选值：0、1

本参数指定几何优化使用的坐标类型。如ICoord=0，采用直角坐标；如ICoord=1，采用冗余内坐标。对于DL-Find优化器，默认值为0；对于BDF优化器，默认值为1，且不支持1以外的值。

:guilabel:`ILine` 参数类型：整型
------------------------------------------------
 * 可选值：0、1

本参数指定是否在几何优化过程中进行线性搜索；如不进行线性搜索，则只进行二次搜索。ILine=0表示不进行线性搜索，否则表示进行线性搜索。对于DL-Find优化器，默认值为0；对于BDF优化器，默认值为1。

:guilabel:`Constrain` 参数类型：整数数列
---------------------------------------------------

本参数指定进行约束性优化（constrained optimization），即在约束一个或多个键长、键角或二面角的情况下，优化分子其余的自由度。目前本参数仅支持BDF优化器。该关键词后面的第一行应是一个整数，表示约束的数目，设其为N；第2行到第N+1行，每一行分别由2~4个整数组成。如某一行有2个整数，表示原子编号为这2个整数的原子之间的键被冻结；如某一行有3个整数，表示原子编号为这3个整数的原子之间的键角被冻结；如某一行有4个整数，表示原子编号为这4个整数的原子之间的二面角被冻结。

.. code-block:: bdf

     $bdfopt
     Constrain
     2
     1 5        #1号原子-5号原子之间的化学键被冻结
     1 4 8      #1号原子-4号原子-8号原子的键角被冻结
     $end

:guilabel:`Hess` 参数类型：字符串
------------------------------------------------
 * 可选值：only、init、final、init+final

指定计算数值Hessian。如为only，则仅计算数值Hessian而不做几何结构优化。如数值Hessian计算正常结束，程序将把Hessian对角化并进行热化学分析，给出振动频率、振动简正模、零点能、内能、焓、熵、Gibbs自由能等数据。如为init，则首先计算数值Hessian，然后以其为初始Hessian进行几何结构优化。该方法主要应用于过渡态搜索中（因为默认的基于分子力场的初始Hessian缺乏虚频）。程序不对该Hessian进行热化学分析。如为final，则首先进行结构优化，如结构优化收敛，则在收敛的几何结构上计算数值Hessian，并进行频率分析和热化学分析。在其他量化程序中，这种计算模式常被称为opt+freq。如为init+final，则首先计算初始数值Hessian，然后进行几何结构优化，优化收敛后再计算数值Hessian。程序仅对后一个数值Hessian进行频率分析和热化学分析，而不对前一个数值Hessian进行这些分析。

:guilabel:`ReCalcHess` 参数类型：整型
---------------------------------------------------
 * 可选值：非负整数

指定在几何优化中，每隔多少步计算一次数值Hessian。如不提供该关键词，默认在几何优化过程中不计算数值Hessian（除非指定了Update=0）。

:guilabel:`NumHessStep` 参数类型：浮点型
------------------------------------------------
 * 默认值：0.001
 * 可选值：正实数

建议范围：0.001 ~ 0.01

指定数值Hessian计算时，扰动分子的步长（单位：Bohr）。

:guilabel:`ReadHess` 参数类型：Bool型
---------------------------------------------------
指定读取$BDFTASK.hess作为结构优化的初始Hessian（其中$BDFTASK为当前输入文件的名字去掉后缀.inp得到的字符串）。$BDFTASK.hess可以由其他的频率计算任务产生，而不一定需要和当前结构优化计算的理论级别一致。

:guilabel:`RestartHess` 参数类型：Bool型
---------------------------------------------------
指定对频率任务进行断点续算。

:guilabel:`NDeg` 参数类型：整型
---------------------------------------------------
 * 默认值：1
 * 可选值：正整数

指定当前电子态的电子简并度，用于计算热化学分析中的吉布斯自由能。电子简并度等于空间简并度乘以自旋简并度，其中空间简并度等于当前电子态所属不可约表示的维数（当分子属于阿贝尔群时，空间简并度等于1），自旋简并度对于非相对论计算和标量相对论计算等于自旋多重度（2S+1），而对考虑了旋轨耦合的计算等于2J+1，其中J为当前电子态的总角动量量子数。注意即使对于电子简并度不等于1的体系，NDeg的默认值仍然是1，用户必须手动指定正确的NDeg值，这一点对于开壳层体系的吉布斯自由能计算尤其重要。

:guilabel:`Temp` 参数类型：浮点型
---------------------------------------------------
 * 默认值：298.15
 * 可选值：正实数

指定在什么温度下进行热化学分析（单位：K）。

:guilabel:`Press` 参数类型：浮点型
---------------------------------------------------
 * 默认值：1.0
 * 可选值：正实数

指定在什么压强下进行热化学分析（单位：atm）。

:guilabel:`Scale` 参数类型：浮点型
---------------------------------------------------
 * 默认值：1.0
 * 可选值：正实数

指定频率分析的校正因子。
