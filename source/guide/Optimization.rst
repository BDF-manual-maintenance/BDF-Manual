势能面和几何优化
================================================

几何优化的目的是找到体系势能面的极小点。能找到哪个极小点取决于输入文件中提供的初猜结构，离哪个极小点越近，一般越容易收敛到哪个极小点。

几何优化在数学上等价于寻找多元函数极值问题：

.. math::
    F_{i} = -\frac{\partial E(R_1,R_2,\dots,R_N)}{\partial R_i} = 0, i=1,2,\dots,N

几何优化常用算法如下：

#. 最速下降法（Steepest descent）：最速下降法就是沿着负梯度的方向进行线搜索，对于远离极小点的结构，最速下降法优化效率非常高，但临近极小点时收敛慢，容易震荡。
#. 共轭梯度法（Conjugate gradient）：共轭梯度法是最速下降法的改良，每步优化方向与前一步的优化方向相组合,能一定程度缓解震荡问题。
#. 牛顿法（Newton method）：牛顿法的思路是将函数相对于当前位置进行泰勒级数展开。牛顿法收敛很快，对于二次函数一步就可以走到极小点。但是牛顿法需要求解Hessian矩阵，计算非常太昂贵，一般几何优化中使用准牛顿法。
#. 准牛顿法（Quasi-Newton method）：准牛顿法通过近似方法构建 Hessian矩阵，当前步的Hessian矩阵基于当前步的受力和上一步的Hessian矩阵来得到。具体做法有多种，最常用的是BFGS法，还有DFP、MS、PSB等。由于准牛顿法的 Hessian是近似构建的，所以每一步优化的准确度低于牛顿法，达到收敛所需步数更多。但由于每一步耗时大为降低，所以优化总耗时还是显著减少了。


基态结构优化
-------------------------------------------------------

激发态结构优化
-------------------------------------------------------

限制性结构优化
-------------------------------------------------------

冗余坐标优化
-------------------------------------------------------

几何优化常见问题
-------------------------------------------------------

虚频问题
########################################################

对称性问题
########################################################

几何优化不收敛
########################################################

